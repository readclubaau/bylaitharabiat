<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø§Ø¯ÙŠ Ø§Ù‚Ø±Ø£ - Ù…ØªØ¬Ø± Ø§Ù„ÙƒØªØ¨</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <link rel="apple-touch-icon" href="https://archive.org/download/20251223_20251223_1703/%D8%A7%D9%82%D8%B1%D8%A3.jpg">
    <link rel="icon" href="https://archive.org/download/20251223_20251223_1703/%D8%A7%D9%82%D8%B1%D8%A3.jpg">
    <style>
        /* --------------------------------------------------
           1. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø©
           -------------------------------------------------- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Cairo', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: #fcf8ec; 
            color: #5d4037;
            min-height: 100vh;
            overflow-x: hidden;
            padding-bottom: 0; 
        }

        /* --------------------------------------------------
           2. Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ù†ØªØ±Ùˆ
           -------------------------------------------------- */
        #intro-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d1b00 100%);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 1s ease-in-out;
            padding: 20px;
            overflow: hidden; 
        }

        .intro-content {
            text-align: center;
            position: relative;
            width: 100%;
            max-width: 320px;
            z-index: 10; 
        }

        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ */
        .book-emojis {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1; 
        }

        /* --- Ø­Ø±ÙƒØ© Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ --- */
        .book-emoji {
            position: absolute;
            font-size: 28px;
            top: 50%;
            left: 50%;
            opacity: 0;
            animation: luxuriousFloat 3s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
        }

        @keyframes luxuriousFloat {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.3) rotate(0deg); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(0.8) rotate(10deg); }
            100% { opacity: 0; transform: translate(calc(-50% + var(--tx)), calc(-50% + var(--ty))) scale(1.1) rotate(var(--rot)); }
        }

        .logo-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(45deg, #f2cd7c, #a17506);
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto 20px;
            box-shadow: 0 0 40px rgba(242, 205, 124, 0.2);
            animation: pulse 3s infinite ease-in-out;
            position: relative;
            z-index: 10; 
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }

        .logo-circle img {
            width: 80%;
            height: 80%;
            border-radius: 50%;
            object-fit: cover;
        }

        .intro-title {
            color: #f2cd7c;
            font-size: 1.8rem;
            font-weight: 900;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }

        .loading-container {
            width: 100%;
            max-width: 280px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 3px;
            margin: 15px auto;
        }

        .loading-bar {
            height: 6px;
            background: linear-gradient(90deg, #a17506, #f2cd7c);
            border-radius: 8px;
            width: 0%;
            transition: width 0.1s linear; 
        }

        .loading-text {
            color: #f2cd7c;
            margin-top: 10px;
            font-size: 0.8rem;
            letter-spacing: 1px;
        }

        .fade-out {
            opacity: 0;
            pointer-events: none;
        }

        /* --------------------------------------------------
           3. Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
           -------------------------------------------------- */
        #main-store {
            opacity: 0;
            transition: opacity 1s ease;
            padding-bottom: 60px;
        }

        .show-main {
            opacity: 1 !important;
        }

        .navbar {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 20px;
            background-color: #f7f1e1;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo-text {
            font-weight: 900;
            font-size: 1.3rem;
            color: #a17506;
            margin-bottom: 10px;
        }

        .nav-links {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .nav-links a {
            text-decoration: none;
            color: #8d6e63;
            font-weight: 700;
            font-size: 0.9rem;
            padding: 5px 10px;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .nav-links a:hover {
            color: #a17506;
        }

        .search-box {
            width: 100%;
            max-width: 300px;
            position: relative;
        }

        .search-box input {
            padding: 10px 15px;
            border-radius: 20px;
            border: 1px solid #d7ccc8;
            background: #fff;
            outline: none;
            width: 100%;
            font-family: 'Cairo';
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        
        .search-box input:focus {
            border-color: #a17506;
            box-shadow: 0 0 5px rgba(161, 117, 6, 0.2);
        }

        .hero-section {
            position: relative; 
            text-align: center;
            padding: 40px 15px; 
            background-color: #2d1b00; 
            overflow: hidden; 
            min-height: 250px; 
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø®Ù„ÙÙŠ */
        #hero-video-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 0; 
            opacity: 0.4; 
            filter: brightness(0.6); 
        }

        /* Ø·Ø¨Ù‚Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙÙˆÙ‚ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ */
        .hero-content {
            position: relative;
            z-index: 2; 
            width: 100%;
        }

        .main-logo-frame {
            width: 150px;
            height: 150px;
            margin: 0 auto;
            border-radius: 50%;
            border: 6px solid #cfaa56;
            padding: 8px;
            background: rgba(255, 255, 255, 0.9);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .main-logo-frame img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .hero-title {
            margin-top: 15px;
            font-size: 2.2rem;
            color: #fcf8ec; 
            font-weight: 900;
            text-shadow: 0 2px 10px rgba(0,0,0,0.8);
        }

        .hero-subtitle {
            font-size: 0.9rem;
            color: #fff;
            letter-spacing: 1px;
            margin-top: 8px;
            text-transform: uppercase;
            border-top: 2px solid #cfaa56;
            border-bottom: 2px solid #cfaa56;
            display: inline-block;
            padding: 4px 15px;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(2px);
        }

        .categories-wrapper {
            margin: 20px auto;
            padding: 0 15px;
            display: flex;
            justify-content: flex-start;
            flex-wrap: nowrap;
            gap: 8px;
            overflow-x: auto;
            scrollbar-width: none;
        }

        .cat-btn {
            background: transparent;
            border: 2px solid #cfaa56;
            color: #5d4037;
            padding: 6px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .cat-btn.active {
            background: #a17506;
            color: #fff;
            border-color: #a17506;
        }

        /* --------------------------------------------------
           4. Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙÙˆÙ
           -------------------------------------------------- */
        .shelves-container {
            margin: 0 auto;
            padding-bottom: 20px;
            min-height: 300px; 
        }

        .shelf-wrapper {
            margin-bottom: 40px;
            transition: all 0.5s ease;
            pointer-events: none !important;
        }
        
        .shelf-wrapper.hidden-shelf {
            display: none;
        }

        .shelf-title {
            text-align: right;
            padding-right: 25px;
            margin-bottom: -10px;
            position: relative;
            z-index: 5;
            color: #a17506;
            font-weight: 800;
            font-size: 1.1rem;
            text-shadow: 1px 1px 0 #fff;
            pointer-events: none;
        }

        .shelf-row {
            position: relative;
            width: 100%;
            height: 220px; 
            display: flex;
            align-items: flex-end;
            pointer-events: none;
        }

        .books-track {
            display: flex;
            overflow-x: auto; 
            scroll-behavior: smooth;
            width: 100%;
            height: 100%;
            align-items: flex-end;
            position: relative;
            z-index: 5; 
            padding-bottom: 35px; 
            padding-right: 20px;
            padding-left: 20px;
            gap: 50px; 
            scrollbar-width: none; 
            -ms-overflow-style: none; 
            pointer-events: auto !important; 
        }

        .books-track::-webkit-scrollbar {
            display: none; 
        }

        /* Book Item */
        .book-item {
            flex-shrink: 0;
            position: relative;
            cursor: pointer;
            transform: none; 
            perspective: 800px; 
            margin-bottom: 0px; 
            padding-bottom: 5px; 
            user-select: none;
            pointer-events: auto !important;
            z-index: 100;
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        
        .book-item.hidden-book {
            display: none;
        }

        .book-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 9999; 
            background: transparent;
        }

        .book-frame {
            position: relative;
            width: 100px;
            height: 150px;
            background-color: transparent;
            border: none;
            box-shadow: none;
            transform-style: preserve-3d;
            transform-origin: bottom center; 
            transform: rotateX(10deg); 
            transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            pointer-events: none; 
        }

        .book-item:active .book-frame {
            transform: rotateX(10deg) scale(0.95);
        }

        .book-cover {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 4px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3); 
        }

        .book-price {
            position: absolute;
            top: 5px;
            left: 3px;
            background-color: #f7f1e1; 
            color: #a17506; 
            border: 1px solid #cfaa56;
            padding: 2px 8px;
            border-radius: 12px; 
            font-size: 0.7rem;
            font-weight: 900;
            box-shadow: 0 3px 6px rgba(0,0,0,0.25);
            z-index: 20; 
            transform: translateZ(15px); 
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .book-ribbon {
            position: absolute;
            bottom: 20px; 
            left: -10px; 
            width: calc(100% + 20px); 
            background: linear-gradient(to right, #a17506, #f2cd7c, #e4b658, #a17506);
            color: #5d4037;
            text-align: center;
            font-size: 0.6rem;
            font-weight: 800;
            padding: 4px 2px;
            text-shadow: 0px 1px 0px rgba(255,255,255,0.5);
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            z-index: 10;
            clip-path: polygon(0 0, 100% 0, 97% 100%, 3% 100%);
            transform: translateZ(2px);
        }

        .book-ribbon::before, .book-ribbon::after {
             content: '';
             position: absolute;
             top: 100%; 
             border-style: solid;
             filter: brightness(0.6); 
        }

        .book-ribbon::before {
             left: 0;
             border-width: 0 10px 10px 0;
             border-color: transparent #a17506 transparent transparent;
        }
        
        .book-ribbon::after {
             right: 0;
             border-width: 0 0 10px 10px;
             border-color: transparent transparent transparent #a17506;
        }

        /* Wood Shelf */
        .wood-shelf {
            position: absolute;
            bottom: 23px; 
            left: 0; 
            width: 100%; 
            height: 24px;
            background: 
                url('https://www.transparenttextures.com/patterns/wood-pattern.png'),
                linear-gradient(180deg, #a67c52 0%, #8a5e3a 50%, #734b36 100%);
            border-radius: 0; 
            border-top: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: inset 0 2px 3px rgba(255,255,255,0.2);
            z-index: 10; 
            pointer-events: none !important; 
        }
        
        .wood-shelf::after {
            content: '';
            position: absolute;
            top: 24px;
            left: 0;
            right: 0;
            height: 18px;
            background: 
                url('https://www.transparenttextures.com/patterns/wood-pattern.png'),
                linear-gradient(to bottom, #5a3d31 0%, #3e2723 100%);
            border-radius: 0;
            box-shadow: 
                inset 0 6px 10px rgba(0,0,0,0.7),
                0 25px 40px rgba(0,0,0,0.5);
            z-index: 10;
            pointer-events: none !important;
        }

        /* --------------------------------------------------
           5. Ø§Ù„Ù†ÙˆØ§ÙØ° ÙˆØ§Ù„Ø³Ù„Ø©
           -------------------------------------------------- */
        .cart-icon-float {
            position: fixed;
            bottom: 80px; 
            left: 20px;
            width: 60px;
            height: 60px;
            background: #a17506;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            cursor: pointer;
            z-index: 1000;
            transition: transform 0.3s ease;
            pointer-events: auto;
        }
        
        .cart-icon-float:hover {
            transform: scale(1.1);
        }

        .cart-icon-float span {
            font-size: 28px;
            color: #fff;
        }

        .cart-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #d32f2f;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 12px;
            font-weight: bold;
            border: 2px solid #fff;
        }

        /* Floating Action Button for Sharing */
        .share-fab-btn { 
            position: fixed; bottom: 160px; left: 20px; width: 50px; height: 50px; 
            background: #2196F3; border-radius: 50%; display: none; /* Hidden by default */
            justify-content: center; align-items: center; 
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.3); cursor: pointer; z-index: 999;
            color: white; font-size: 24px; border: 2px solid white;
            animation: bounceIn 0.5s;
        }
        @keyframes bounceIn { 0% { transform: scale(0); } 80% { transform: scale(1.1); } 100% { transform: scale(1); } }

        /* Modal Overlay */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            pointer-events: auto;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Custom Modal Structure */
        .custom-modal {
            position: relative;
            width: 90%;
            max-width: 500px;
            overflow: visible; 
            transform: translateY(50px);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            background: transparent;
            box-shadow: none;
            border: none;
        }

        .modal-overlay.active .custom-modal {
            transform: translateY(0);
        }

        .modal-content-wrapper {
            background: #fcf8ec;
            border-radius: 20px;
            overflow: hidden; 
            border: 4px solid #cfaa56;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            max-height: 85vh;
            overflow-y: auto;
            -ms-overflow-style: none;  
            scrollbar-width: none;  
        }
        
        .modal-content-wrapper::-webkit-scrollbar {
            display: none;
        }

        /* Popped-out Close Button */
        .modal-close-btn {
            position: absolute;
            top: -12px; 
            left: -12px;
            width: 32px; 
            height: 32px;
            z-index: 100;
            background: linear-gradient(135deg, #cfaa56, #a17506); 
            color: #fcf8ec; 
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            font-weight: 400; 
            font-size: 1.4rem;
            line-height: 1;
            border: 2px solid #fcf8ec; 
            box-shadow:
                0 4px 8px rgba(161, 117, 6, 0.3), 
                inset 0 1px 1px rgba(255, 255, 255, 0.4); 
            transition: all 0.3s ease;
        }
        
        .modal-close-btn:hover {
            transform: scale(1.1) rotate(90deg); 
            background: linear-gradient(135deg, #d4b36a, #b38308); 
            box-shadow: 0 6px 12px rgba(161, 117, 6, 0.4);
        }

        /* Product Details */
        .modal-image-container {
            width: 100%;
            height: 280px; 
            background: #fcf8ec; 
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            flex-shrink: 0;
        }

        .modal-image {
            width: 100%;
            height: 100%;
            object-fit: contain; 
            border-radius: 4px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2); 
        }

        .modal-details {
            padding: 20px 25px; 
            text-align: center;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 900;
            color: #a17506;
            margin-bottom: 10px;
        }

        .modal-desc {
            font-size: 0.95rem;
            color: #5d4037;
            line-height: 1.6;
            margin-bottom: 20px;
            white-space: pre-wrap;
        }

        .modal-price-tag {
            display: inline-block;
            background: #f7f1e1;
            color: #a17506;
            border: 2px solid #cfaa56;
            padding: 5px 20px;
            border-radius: 50px;
            font-weight: 900;
            font-size: 1.2rem;
            margin-bottom: 15px;
        }

        /* Quantity Selector */
        .quantity-selector {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .qty-btn {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: 2px solid #cfaa56;
            background: #fff;
            color: #a17506;
            font-weight: bold;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.2s ease;
        }

        .qty-btn:active {
            background: #cfaa56;
            color: #fff;
        }

        .qty-display {
            font-size: 1.3rem;
            font-weight: 900;
            color: #5d4037;
            min-width: 30px;
            text-align: center;
        }

        .main-action-btn {
            background: linear-gradient(45deg, #a17506, #cfaa56);
            color: #fff;
            border: none;
            width: 100%;
            padding: 15px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(161, 117, 6, 0.3);
            transition: transform 0.2s, box-shadow 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .main-action-btn:active {
            transform: scale(0.98);
            box-shadow: 0 2px 5px rgba(161, 117, 6, 0.3);
        }

        .main-action-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            box-shadow: none;
        }

        /* Cart Content */
        .cart-header { background: #f7f1e1; padding: 20px; text-align: center; border-bottom: 2px solid #cfaa56; }
        .cart-header h2 { color: #a17506; font-weight: 900; }
        .cart-body { padding: 20px; }
        .cart-items-list { max-height: 300px; overflow-y: auto; margin-bottom: 20px; padding-right: 5px; scrollbar-width: none; }
        .cart-items-list::-webkit-scrollbar { width: 5px; }
        .cart-items-list::-webkit-scrollbar-track { background: #f1f1f1; }
        .cart-items-list::-webkit-scrollbar-thumb { background: #cfaa56; border-radius: 10px; }

        .cart-item-preview { display: flex; align-items: center; justify-content: space-between; background: #fff; padding: 10px; border-radius: 10px; border: 1px solid #d7ccc8; margin-bottom: 10px; }
        .cart-item-left { display: flex; align-items: center; }
        .cart-item-img { width: 50px; height: 70px; object-fit: cover; border-radius: 5px; margin-left: 15px; }
        .cart-item-info h4 { color: #5d4037; font-size: 0.9rem; margin-bottom: 5px; }
        .cart-item-price { color: #a17506; font-weight: bold; font-size: 0.9rem; display: block; }
        .qty-badge { font-size: 0.7rem; background: #eee; padding: 2px 6px; border-radius: 4px; color: #666; }
        .remove-item-btn { background: #ffebee; color: #d32f2f; border: none; width: 30px; height: 30px; border-radius: 50%; cursor: pointer; display: flex; justify-content: center; align-items: center; font-size: 1rem; transition: background 0.2s; }
        .remove-item-btn:hover { background: #ffcdd2; }
        .cart-summary { border-top: 2px dashed #cfaa56; padding-top: 15px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; font-weight: 900; font-size: 1.1rem; color: #a17506; }
        .empty-cart-msg { text-align: center; color: #8d6e63; font-weight: bold; padding: 20px; }

        .form-group { margin-bottom: 15px; }
        .form-label { display: block; margin-bottom: 5px; color: #5d4037; font-weight: 700; font-size: 0.9rem; }
        .form-input { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #cfaa56; background: #fff; font-family: 'Cairo'; outline: none; transition: border-color 0.3s; }
        .form-input:focus { border-color: #a17506; box-shadow: 0 0 5px rgba(161, 117, 6, 0.2); }
        .error-msg { color: #d32f2f; font-size: 0.8rem; margin-top: 5px; display: none; }
        
        /* Ø±Ø³Ø§Ù„Ø© "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬" */
        .no-results-msg {
            text-align: center;
            padding: 30px;
            font-weight: bold;
            color: #8d6e63;
            font-size: 1.2rem;
            grid-column: 1 / -1; 
            width: 100%;
        }

        /* About Us Design */
        .about-text { font-size: 0.95rem; line-height: 1.8; color: #5d4037; text-align: justify; margin-bottom: 30px; }
        .founder-box { background: linear-gradient(135deg, #ffffff, #fdf7e2); border: 2px solid #cfaa56; border-radius: 15px; padding: 25px; position: relative; box-shadow: 0 8px 20px rgba(161, 117, 6, 0.15); margin-top: 30px; overflow: visible; }
        .founder-box::before { content: 'â'; font-size: 5rem; color: rgba(207, 170, 86, 0.15); position: absolute; top: -20px; right: 15px; font-family: serif; line-height: 1; }
        .founder-box h3 { color: #a17506; font-size: 1.1rem; margin-bottom: 15px; text-align: center; position: relative; display: inline-block; width: 100%; border-bottom: 1px dashed #cfaa56; padding-bottom: 10px; }
        .founder-message { font-style: italic; color: #4a3b32; font-size: 0.9rem; line-height: 1.7; text-align: justify; margin-bottom: 15px; position: relative; z-index: 2; }
        .founder-signature { text-align: left; font-weight: 900; color: #a17506; font-size: 1rem; font-family: 'Cairo', sans-serif; position: relative; z-index: 2; }

        .mobile-nav { position: fixed; bottom: 0; left: 0; width: 100%; background: #f7f1e1; display: flex; justify-content: space-around; padding: 10px 0; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); z-index: 100; pointer-events: auto; }
        .mobile-nav-item { display: flex; flex-direction: column; align-items: center; text-decoration: none; color: #8d6e63; font-size: 0.7rem; font-weight: 600; }
        
        @media (min-width: 768px) { .mobile-nav { display: none; } .navbar { flex-direction: row; justify-content: space-between; } }

        /* --------------------------------------------------
           6. Ø§Ù„ÙÙˆØªØ± Ø§Ù„Ù…ØµØºØ± (Compact & Glowing)
           -------------------------------------------------- */
        .site-footer {
            background: radial-gradient(circle at center, #3d2600 0%, #2d1b00 100%);
            color: #fcf8ec;
            text-align: center;
            /* ØªÙ… ØªØµØºÙŠØ± Ø§Ù„Ø­Ø´ÙˆØ© Ø¨Ø´ÙƒÙ„ ÙƒØ¨ÙŠØ± Ù„Ø¬Ø¹Ù„ Ø§Ù„ÙÙˆØªØ± Ø±ÙÙŠØ¹Ø§Ù‹ */
            padding: 15px 10px; 
            margin-top: 40px;
            border-top: 2px solid #a17506; 
            box-shadow: 0 -5px 15px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 8px; /* Ù…Ø³Ø§ÙØ© ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ Ø¨ÙŠÙ† Ø§Ù„Ø¹Ù†Ø§ØµØ± */
            position: relative;
            z-index: 50;
            overflow: hidden;
            min-height: auto;
        }

        /* Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ø®ÙÙŠÙØ© */
        .site-footer::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(161, 117, 6, 0.08) 0%, transparent 60%);
            pointer-events: none;
            animation: rotateBg 20s linear infinite;
        }
        @keyframes rotateBg { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }


        /* ÙÙŠ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ù†Ø¶ÙŠÙ Ø­Ø´ÙˆØ© Ø³ÙÙ„ÙŠØ© ÙÙ‚Ø· Ù„ÙƒÙŠ Ù„Ø§ ÙŠØºØ·ÙŠ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ØŒ Ù„ÙƒÙ† Ù†Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„ØµØºÙŠØ± */
        @media (max-width: 768px) {
            .site-footer {
                padding-bottom: 30px; 
            }
        }

        .footer-social-icon {
            display: inline-block;
            text-decoration: none;
            position: relative;
            z-index: 2;
            line-height: 0; /* Ù„Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ù…Ø³Ø§ÙØ§Øª Ø¥Ø¶Ø§ÙÙŠØ© */
        }

        /* Ø£ÙŠÙ‚ÙˆÙ†Ø© ØµØºÙŠØ±Ø© ÙˆÙ„ÙƒÙ† Ù…Ø¶ÙŠØ¦Ø© Ø¬Ø¯Ø§Ù‹ */
        .footer-social-icon svg {
            width: 24px; /* Ø­Ø¬Ù… ØµØºÙŠØ± Ø¬Ø¯Ø§Ù‹ ÙˆÙ…Ù†Ø§Ø³Ø¨ */
            height: 24px;
            fill: #cfaa56; 
            filter: drop-shadow(0 0 5px rgba(207, 170, 86, 0.9)) 
                    drop-shadow(0 0 10px rgba(161, 117, 6, 0.6));
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            animation: iconPulse 2s infinite alternate ease-in-out;
        }

        .footer-social-icon:hover svg {
            transform: scale(1.2);
            fill: #fff; 
            filter: drop-shadow(0 0 8px rgba(207, 170, 86, 1)) 
                    drop-shadow(0 0 15px rgba(242, 205, 124, 0.9))
                    brightness(1.2);
        }

        @keyframes iconPulse {
            0% { filter: drop-shadow(0 0 4px rgba(207, 170, 86, 0.7)); transform: scale(1); }
            100% { filter: drop-shadow(0 0 8px rgba(207, 170, 86, 1)); transform: scale(1.1); }
        }

        /* Ù†Øµ ØµØºÙŠØ± ÙˆØ£Ù†ÙŠÙ‚ */
        .footer-copyright {
            font-size: 0.7rem; /* Ø®Ø· ØµØºÙŠØ± Ø¬Ø¯Ø§Ù‹ */
            letter-spacing: 0.5px;
            opacity: 0.9;
            direction: ltr; 
            text-transform: uppercase;
            position: relative;
            z-index: 2;
            font-weight: 600;
            line-height: 1;
        }

        /* Ø§Ø³Ù… Ø§Ù„Ù…Ø·ÙˆØ± Ù…Ø¶ÙŠØ¡ ÙˆØµØºÙŠØ± */
        .developer-name {
            color: #cfaa56;
            font-weight: 800;
            position: relative;
            display: inline-block;
            padding: 0 3px;
            text-shadow: 0 0 4px rgba(207, 170, 86, 0.8);
            animation: textGlowPulse 3s infinite alternate ease-in-out;
        }
        
        @keyframes textGlowPulse {
             0% { text-shadow: 0 0 3px rgba(207, 170, 86, 0.6); }
             100% { text-shadow: 0 0 8px rgba(207, 170, 86, 1); }
        }

    </style>
</head>
<body>

    <div id="intro-screen">
        <div class="book-emojis" id="book-emojis"></div>
        <div class="intro-content">
            <div class="logo-circle"><img src="https://archive.org/download/20251125_20251125_0813/%D8%A7%D9%82%D8%B1%D8%A3.jpg" alt="Logo"></div>
            <h1 class="intro-title">Ù†Ø§Ø¯ÙŠ Ø§Ù‚Ø±Ø£</h1>
            <div class="loading-container"><div class="loading-bar" id="progress-bar"></div></div>
            <div class="loading-text" id="loading-text">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙƒØªØ¨Ø©...</div>
        </div>
    </div>

    <div id="main-store">
        <nav class="navbar">
            <div class="logo-text">Ù†Ø§Ø¯ÙŠ Ø§Ù‚Ø±Ø£</div>
            <div class="nav-links">
                <a href="#" id="nav-home-link">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
                <a href="#" id="nav-share-link">Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©</a>
                <a href="#" id="nav-borrow-link">Ø§Ø³ØªØ¹Ø§Ø±Ø© ÙƒØªØ§Ø¨</a>
                <a href="#" id="sell-book-link">Ø¨ÙŠØ¹ ÙƒØªØ§Ø¨</a>
                <a href="#" id="nav-about-link">Ù…Ù† Ù†Ø­Ù†</a>
            </div>
            <div class="search-box">
                <input type="text" id="search-input" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† ÙƒØªØ§Ø¨...">
            </div>
        </nav>

        <header class="hero-section">
            <video autoplay muted loop playsinline id="hero-video-bg" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 0; opacity: 0.4; filter: brightness(0.6);">
                <source src="https://cdn.pixabay.com/video/2025/11/28/318598.mp4" type="video/mp4">
            </video>
            <div class="hero-content" style="position: relative; z-index: 2;">
                <div class="main-logo-frame"><img src="https://archive.org/download/20251223_20251223_1703/%D8%A7%D9%82%D8%B1%D8%A3.jpg" alt="Club Logo"></div>
                <h1 class="hero-title">Ù†ÙØ§Ø¯ÙÙŠ Ø§Ù‚Ù’Ø±ÙØ£</h1>
                <div class="hero-subtitle">GOODBOOKS GOOD COMPANY</div>
            </div>
        </header>

        <div class="categories-wrapper">
            <button class="cat-btn active" data-filter="all">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</button>
            
            <button class="cat-btn" data-filter="novels">Ø§Ù„Ø±ÙˆØ§ÙŠØ§Øª ÙˆØ§Ù„Ø£Ø¯Ø¨</button>
            <button class="cat-btn" data-filter="self-dev">Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</button>
            <button class="cat-btn" data-filter="history">Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„Ø­Ø¶Ø§Ø±Ø©</button>
            <button class="cat-btn" data-filter="kids">Ø±ÙƒÙ† Ø§Ù„Ø·ÙÙ„</button>
            <button class="cat-btn" data-filter="science">Ø§Ù„Ø¹Ù„ÙˆÙ… ÙˆØ§Ù„Ù…Ø¹Ø±ÙØ©</button>
            <button class="cat-btn" data-filter="psychology">Ø¹Ù„Ù… Ø§Ù„Ù†ÙØ³</button>
            <button class="cat-btn" data-filter="philosophy">ÙÙ„Ø³ÙØ©</button>
            <button class="cat-btn" data-filter="spirituality">Ø±ÙˆØ­Ø§Ù†ÙŠØ§Øª</button>
            <button class="cat-btn" data-filter="short-stories">Ù‚ØµØµ Ù‚ØµÙŠØ±Ø©</button>
            <button class="cat-btn" data-filter="biography">Ø³ÙŠØ±Ø© Ø°Ø§ØªÙŠØ©</button>
            <button class="cat-btn" data-filter="poetry">Ø´Ø¹Ø±</button>
        </div>

        <div class="shelves-container" id="shelves-container"></div>
        
        <div class="share-fab-btn" id="share-fab-btn" title="Ø´Ø§Ø±Ùƒ ÙƒØªØ§Ø¨Ùƒ">+</div>
        <div class="cart-icon-float" id="cart-icon"><span>ğŸ›’</span><div class="cart-badge" id="cart-count">0</div></div>
        
        <div class="mobile-nav">
            <a href="#" class="mobile-nav-item active" id="mobile-home-link"><span>ğŸ </span><span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></a>
            <a href="#" class="mobile-nav-item" id="mobile-share-btn"><span>ğŸ</span><span>Ù…Ø´Ø§Ø±ÙƒØ©</span></a>
            <a href="#" class="mobile-nav-item" id="mobile-borrow-btn"><span>ğŸ¤</span><span>Ø§Ø³ØªØ¹Ø§Ø±Ø©</span></a>
            <a href="#" class="mobile-nav-item" id="mobile-sell-btn"><span>ğŸ’°</span><span>Ø¨ÙŠØ¹ ÙƒØªØ§Ø¨</span></a>
        </div>

        <footer class="site-footer">
            <a href="https://www.instagram.com/laithdeveloper" target="_blank" class="footer-social-icon" title="ØªØ§Ø¨Ø¹ Ø§Ù„Ù…Ø·ÙˆØ± Ø¹Ù„Ù‰ Ø¥Ù†Ø³ØªØ¬Ø±Ø§Ù…">
                <svg viewBox="0 0 24 24">
                    <path d="M7.8,2H16.2C19.4,2 22,4.6 22,7.8V16.2A5.8,5.8 0 0,1 16.2,22H7.8C4.6,22 2,19.4 2,16.2V7.8A5.8,5.8 0 0,1 7.8,2M7.6,4A3.6,3.6 0 0,0 4,7.6V16.4C4,18.39 5.61,20 7.6,20H16.4A3.6,3.6 0 0,0 20,16.4V7.6C20,5.61 18.39,4 16.4,4H7.6M17.25,5.5A1.25,1.25 0 0,1 18.5,6.75A1.25,1.25 0 0,1 17.25,8A1.25,1.25 0 0,1 16,6.75A1.25,1.25 0 0,1 17.25,5.5M12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9Z" />
                </svg>
            </a>
            <div class="footer-copyright">
                Designed & Developed by <span class="developer-name">Laith Arabiat</span>Â©2025
            </div>
        </footer>

    </div>

    <div class="modal-overlay" id="product-modal-overlay">
        <div class="custom-modal">
            <div class="modal-close-btn" id="close-product-modal">&times;</div>
            <div class="modal-content-wrapper">
                <div class="modal-image-container"><img src="" alt="ØºÙ„Ø§Ù Ø§Ù„ÙƒØªØ§Ø¨" class="modal-image" id="modal-img"></div>
                <div class="modal-details">
                    <h2 class="modal-title" id="modal-title"></h2>
                    <p class="modal-desc" id="modal-desc"></p>
                    <div class="modal-price-tag" id="modal-price"></div>
                    <div class="quantity-selector">
                        <button class="qty-btn minus">-</button>
                        <span class="qty-display">1</span>
                        <button class="qty-btn plus">+</button>
                    </div>
                    <button class="main-action-btn" id="add-to-cart-btn"><span>Ø§Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©</span><span>ğŸ›ï¸</span></button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="cart-modal-overlay"><div class="custom-modal"><div class="modal-close-btn" id="close-cart-modal">&times;</div><div class="modal-content-wrapper"><div class="cart-header"><h2>Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h2></div><div class="cart-body"><div id="cart-items-container"><p class="empty-cart-msg">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ© Ø­Ø§Ù„ÙŠØ§Ù‹</p></div><div id="checkout-form-container" style="display: none;"><div class="cart-summary"><span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ:</span><span id="cart-total">0.00 JD</span></div><form id="checkout-form"><div class="form-group"><label class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„</label><input type="text" class="form-input" id="fname" required></div><div class="form-group"><label class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ</label><input type="text" class="form-input" id="lname" required></div><div class="form-group"><label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (10 Ø£Ø±Ù‚Ø§Ù…)</label><input type="tel" class="form-input" id="phone" placeholder="07XXXXXXXX" maxlength="10" inputmode="numeric" required><p class="error-msg" id="phone-error">ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªÙƒÙˆÙ† Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù…Ù† 10 Ø®Ø§Ù†Ø§Øª.</p></div><div class="form-group"><label class="form-label">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠ</label><input type="tel" class="form-input" id="uni-id" inputmode="numeric" required></div><button type="submit" class="main-action-btn"><span>Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</span><span>âœ…</span></button></form></div></div></div></div></div>
    
    <div class="modal-overlay" id="sell-modal-overlay">
        <div class="custom-modal">
            <div class="modal-close-btn" id="close-sell-modal">&times;</div>
            <div class="modal-content-wrapper">
                <div class="cart-header"><h2>Ø¹Ø±Ø¶ ÙƒØªØ§Ø¨ Ù„Ù„Ø¨ÙŠØ¹</h2></div>
                <div class="cart-body">
                    <form id="sell-form">
                        <div class="form-group"><label class="form-label">Ø§Ø³Ù… Ø§Ù„ÙƒØªØ§Ø¨</label><input type="text" class="form-input" id="sell-book-title" required></div>
                        <div class="form-group"><label class="form-label">ØªØµÙ†ÙŠÙ Ø§Ù„ÙƒØªØ§Ø¨</label><select id="sell-book-category" class="form-input" style="height: 45px;" required><option value="" disabled selected>Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ</option><option value="novels">Ø§Ù„Ø±ÙˆØ§ÙŠØ§Øª ÙˆØ§Ù„Ø£Ø¯Ø¨</option><option value="self-dev">Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</option><option value="history">Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„Ø­Ø¶Ø§Ø±Ø©</option><option value="kids">Ø±ÙƒÙ† Ø§Ù„Ø·ÙÙ„</option><option value="science">Ø§Ù„Ø¹Ù„ÙˆÙ… ÙˆØ§Ù„Ù…Ø¹Ø±ÙØ©</option><option value="psychology">Ø¹Ù„Ù… Ø§Ù„Ù†ÙØ³</option><option value="philosophy">ÙÙ„Ø³ÙØ©</option><option value="spirituality">Ø±ÙˆØ­Ø§Ù†ÙŠØ§Øª</option><option value="short-stories">Ù‚ØµØµ Ù‚ØµÙŠØ±Ø©</option><option value="biography">Ø³ÙŠØ±Ø© Ø°Ø§ØªÙŠØ©</option><option value="poetry">Ø´Ø¹Ø±</option></select></div>
                        <div class="form-group"><label class="form-label">Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (JD)</label><input type="number" class="form-input" id="sell-book-price" step="0.1" required></div>
                        
                        <div class="form-group"><label class="form-label">ÙˆØµÙ Ø§Ù„ÙƒØªØ§Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label><textarea class="form-input" id="sell-book-desc" rows="2" placeholder="Ø­Ø§Ù„Ø© Ø§Ù„ÙƒØªØ§Ø¨ØŒ Ø§Ù„Ø·Ø¨Ø¹Ø©ØŒ Ù…Ù„Ø§Ø­Ø¸Ø§Øª..."></textarea></div>

                        <div class="form-group"><label class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ Ù„Ù„Ø¨Ø§Ø¦Ø¹</label><input type="text" class="form-input" id="sell-fname" required></div>
                        <div class="form-group"><label class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ Ù„Ù„Ø¨Ø§Ø¦Ø¹</label><input type="text" class="form-input" id="sell-lname" required></div>
                        <div class="form-group"><label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (07XXXXXXXX)</label><input type="tel" class="form-input" id="sell-phone" maxlength="10" inputmode="numeric" required><p class="error-msg" id="sell-phone-error">ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªÙƒÙˆÙ† Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù…Ù† 10 Ø®Ø§Ù†Ø§Øª.</p></div>
                        <div class="form-group"><label class="form-label">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠ</label><input type="tel" class="form-input" id="sell-uni-id" inputmode="numeric" required></div>
                        <button type="submit" class="main-action-btn"><span>Ù…ØªØ§Ø¨Ø¹Ø© Ø¥Ù„Ù‰ ÙˆØ§ØªØ³ Ø£Ø¨</span><span>ğŸ’¬</span></button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="borrow-modal-overlay"><div class="custom-modal"><div class="modal-close-btn" id="close-borrow-modal">&times;</div><div class="modal-content-wrapper"><div class="cart-header"><h2>Ø·Ù„Ø¨ Ø§Ø³ØªØ¹Ø§Ø±Ø© ÙƒØªØ§Ø¨</h2></div><div class="cart-body"><form id="borrow-form"><div class="form-group"><label class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„</label><input type="text" class="form-input" id="borrow-fname" required></div><div class="form-group"><label class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ</label><input type="text" class="form-input" id="borrow-lname" required></div><div class="form-group"><label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (10 Ø£Ø±Ù‚Ø§Ù…)</label><input type="tel" class="form-input" id="borrow-phone" placeholder="07XXXXXXXX" maxlength="10" inputmode="numeric" required><p class="error-msg" id="borrow-phone-error">ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªÙƒÙˆÙ† Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù…Ù† 10 Ø®Ø§Ù†Ø§Øª.</p></div><div class="form-group"><label class="form-label">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠ</label><input type="tel" class="form-input" id="borrow-uni-id" inputmode="numeric" required></div><button type="submit" class="main-action-btn"><span>Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø±Ø©</span><span>ğŸ¤</span></button></form></div></div></div></div>

    <div class="modal-overlay" id="about-modal-overlay"><div class="custom-modal"><div class="modal-close-btn" id="close-about-modal">&times;</div><div class="modal-content-wrapper"><div class="cart-header"><h2>Ù…Ù† Ù†Ø­Ù†</h2></div><div class="cart-body about-body" style="padding: 25px;"><p class="about-text">Ù†Ø­Ù† Ù†Ø§Ø¯ÙŠ Ø§Ù‚Ø±Ø£ Ù…Ø¨Ø§Ø¯Ø±Ø© Ø¬Ø§Ù…Ø¹ÙŠØ© Ø§Ù†Ø¨ØªÙ†Ø§Ù‡Ø§ Ø¨Ù‡Ø¯Ù Ø§Ù† ØªØ¹ÙˆØ¯ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø¹Ø§Ø¯Ø© ÙŠÙˆÙ…ÙŠØ©ØŒ ÙˆØ§Ù† ÙŠØµØ¨Ø­ Ø§Ù„ÙÙƒØ± ÙˆØ§Ù„Ø­ÙˆØ§Ø± Ø¬Ø²Ø¡Ø§ Ù…Ù† Ù‡ÙˆÙŠØ© Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠ. Ù†Ø¤Ù…Ù† Ø§Ù† Ø§Ù„ÙƒØªØ§Ø¨ Ù„ÙŠØ³ Ù…Ø¬Ø±Ø¯ ØµÙØ­Ø§Øª ØªÙ‚Ù„Ø¨ØŒ Ø¨Ù„ Ù‡ÙŠ Ø¨Ø¯Ø§ÙŠØ© Ø±Ø­Ù„Ø© ÙˆØ¹ÙŠ ÙˆØªÙ…Ø±Ø¯ Ù„Ù„ÙÙƒØ± ÙˆØ§Ù„Ø¢Ø±Ø§Ø¡ Ø§Ù„Ù…Ø¨Ù†ÙŠØ© . ÙˆØ§Ù† ÙÙŠ ÙƒÙ„ Ø¬Ù„Ø³Ø© Ø­ÙˆØ§Ø± Ù‡ÙŠ Ø®Ø·ÙˆØ© Ù†Ø­Ùˆ Ø¬ÙŠÙ„ ÙˆØ§Ø¹ÙŠ ÙˆÙ…Ø«Ù‚Ù.  Ø§Ù†Ø¨Ø«Ù‚Øª Ø§Ù„ÙÙƒØ±Ø© Ù…Ù† Ø·Ø§Ù„Ø¨Ø© ØªØ¤Ù…Ù† Ø§Ù† Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© ÙŠØ¬Ø¨ Ø§Ù† ØªÙƒÙˆÙ† Ù…Ø³Ø§Ø­Ø© Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø§Ù†Ø³Ø§Ù†ØŒ Ù‚Ø¨Ù„ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© ÙˆØ§Ù„ØªØ­ØµÙŠÙ„ Ø§Ù„Ø¹Ù„Ù…ÙŠ .ÙˆØ§Ù† ÙƒÙ„ ÙƒØªØ§Ø¨ ÙŠØ­Ù…Ù„ Ø¨ÙŠÙ† Ø·ÙŠØ§ØªÙ‡ ÙØ±ØµØ© Ù„ØªØºÙŠÙŠØ± Ø­ÙŠØ§Ø© Ø§Ùˆ ÙÙƒØ± Ø´Ø®Øµ ÙˆØ­ÙŠØ§Ø© ÙƒØ§Ù…Ù„Ø©. Ø­Ù„Ù…Ù†Ø§ Ø¨Ø³ÙŠØ· ÙˆÙ‡Ùˆ: "Ù†Ø­Ù† Ù†Ù‚Ø±Ø§ Ø§Ù„ÙŠÙˆÙ… Ù„Ù†ØºÙŠØ± Ø§Ù„ØºØ¯" ... ÙˆÙ…Ø¹ Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù† Ø§Ù„Ø·Ù„Ø¨Ø© Ø§Ù„Ø´ØºÙˆÙÙŠÙ† ØªØ­ÙˆÙ„ Ù‡Ø°Ø§ Ø§Ù„Ø­Ù„Ù… Ø§Ù„Ù‰ Ù…Ø¨Ø§Ø¯Ø±Ø© Ø­Ù‚ÙŠÙ‚Ø© Ù„Ù†Ø¹ÙŠØ¯ Ù„Ù„ÙƒØªØ§Ø¨ Ù…ÙƒØ§Ù†ØªÙ‡ ÙÙŠ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹.  Ù†Ù‡Ø¯Ù Ø§Ù† ÙŠØ¨Ø¯Ø£ Ø§Ø«Ø±Ù†Ø§ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© ÙˆÙŠØµÙ„ ÙÙŠ ÙŠÙˆÙ… Ø§Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ù‡Ø§Ø´Ù…ÙŠØ©. Ù„Ù†Ø³Ù‡Ù… ÙÙŠ Ù†Ù‡Ø¶Ø© ÙÙƒØ±ÙŠØ© Ø´Ø§Ù…Ù„Ø© ÙˆØ­ÙˆØ§Ø± ÙˆØ§Ø¹Ù ÙˆØ¹ÙˆØ¯Ø© ØµØ§Ø¯Ù‚Ø©.</p><div class="founder-box"><h3>Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø¤Ø³Ø³</h3><p class="founder-message">Ø§Ù†Ø§ ÙŠØ§Ø±Ø§ Ø³Ù„ÙŠÙ…Ø§Ù† Ø§Ù„Ù…Ø¬ÙŠØ¯. Ø£Ø³Ø³Øª Ù†Ø§Ø¯ÙŠ Ø§Ù‚Ø±Ø£ Ù„Ø§Ù†Ù†ÙŠ Ø§Ø¤Ù…Ù† Ø§Ù† Ø§Ù„ÙƒØªØ§Ø¨ Ù„Ø¯ÙŠÙ‡ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ ØªØºÙŠÙŠØ± Ù…Ø§ Ù„Ø§ ÙŠØ³ØªØ·ÙŠØ¹ ØªØºÙŠÙŠØ±Ù‡ Ø´ÙŠØ¡ Ø¢Ø®Ø±. Ù„Ø§Ù†Ù‡ ÙŠÙˆÙ‚Ø¸ Ø§Ù„ÙÙƒØ± ÙˆÙŠÙˆØ³Ø¹ Ø§Ù„Ù…Ø¯Ø§Ø±Ùƒ ÙˆÙŠØ¹ÙŠØ¯ Ø§Ù„Ø§Ù†Ø³Ø§Ù† Ø§Ù„Ù‰ Ø°Ø§ØªÙ‡. Ø§Ø±Ø¯Øª Ø¨Ø¹Ø¶ Ø§Ù„ÙˆÙ‚Øª Ù„Ø§ Ù„Ù†Ù…Ù„Ø£ ÙˆÙ‚ØªØ§Ù‹ Ø¨Ù„ Ù„Ù†Ù…Ù„Ø£ ÙˆØ¹ÙŠØ§Ù‹. Ù†ØªÙ†Ø§Ù‚Ø´ Ù„Ø§ Ù„Ø£Ø¬Ù„ Ø§Ù„Ø¬Ø¯Ù„ Ø¨Ù„ Ù„Ø£Ø¬Ù„ Ø´ÙŠØ¡ Ø§Ø³Ù…Ù‰ Ù„Ø¹Ù‚Ù„ Ø§Ù„Ø§Ù†Ø³Ø§Ù† Ù„ÙŠØªØ¹Ù„Ù…. Ù†Ø¨Ø¯Ø§ Ù…Ù† Ø¬Ø§Ù…Ø¹ØªÙ†Ø§ ÙˆÙ†Ø­Ù„Ù… Ø§Ù† Ù†ØµÙ„ Ø§Ù„Ù‰ ÙˆØ·Ù† . Ù„Ø§Ù†... (Ø§Ù„ÙƒØªØ§Ø¨ Ù‚Ø¯ ÙŠØºÙŠØ± Ø´Ø®ØµØ§Ù‹ØŒ ÙˆØ§Ù„Ø´Ø®Øµ Ù‚Ø¯ ÙŠØºÙŠØ± Ø§Ù„Ø¹Ø§Ù„Ù….) ÙˆÙ†ØªÙ‚Ø¯Ù… Ø¨Ø§Ù„Ø´ÙƒØ± Ù„Ø¬Ø§Ù…Ø¹ØªÙ†Ø§ Ø§Ù„ØªÙŠ Ø¢Ù…Ù†Øª Ø¨Ø­Ù„Ù…Ù†Ø§ ÙˆÙ…Ù†Ø­ØªÙ†Ø§ Ù…Ø³Ø§Ø­Ø© Ù„ØªØªØ­ÙˆÙ„ Ø§Ù„ÙÙƒØ±Ø© Ø§Ù„Ù‰ ÙˆØ§Ù‚Ø¹.</p><div class="founder-signature">ÙŠØ§Ø±Ø§ Ø³Ù„ÙŠÙ…Ø§Ù† Ø§Ù„Ù…Ø¬ÙŠØ¯</div></div></div></div></div></div>

    <div class="modal-overlay" id="share-modal-overlay"><div class="custom-modal"><div class="modal-close-btn" id="close-share-modal">&times;</div><div class="modal-content-wrapper"><div class="cart-header"><h2>Ø´Ø§Ø±Ùƒ ÙƒØªØ§Ø¨Ø§Ù‹ Ø£Ùˆ Ù…Ù„Ø­Ù‚Ø§Ù‹</h2></div><div class="cart-body"><form id="share-form"><div class="form-group"><label class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ø­Ù‚ / Ø§Ù„ÙƒØªØ§Ø¨</label><input type="text" class="form-input" id="share-title" required></div><div class="form-group"><label class="form-label">ØµÙˆØ±Ø© Ø§Ù„Ù…Ù„Ø­Ù‚</label><input type="file" class="form-input" id="share-image-file" accept="image/*" required><p style="font-size:0.7rem; color:#888;">* Ø³ÙŠØªÙ… Ø¶ØºØ· Ø§Ù„ØµÙˆØ±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</p></div><div class="form-group"><label class="form-label">Ø§Ù„ÙˆØµÙ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label><textarea class="form-input" id="share-desc" rows="2"></textarea></div><div class="form-group"><label class="form-label">Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ</label><input type="tel" class="form-input" id="share-phone" maxlength="10" inputmode="numeric" required><p class="error-msg" id="share-phone-error">ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªÙƒÙˆÙ† Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù…Ù† 10 Ø®Ø§Ù†Ø§Øª.</p></div><button type="submit" class="main-action-btn" id="share-submit-btn"><span>Ù†Ø´Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©</span><span>ğŸš€</span></button></form></div></div></div></div>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbyAoLZIBPhciqPs5VcVVPDP9pIKDQ4N4hTkolCIt0UPSDHFQOaQZi9zq9XHkmBnsb7cMg/exec';
        const categories = { 'novels': 'Ø§Ù„Ø±ÙˆØ§ÙŠØ§Øª ÙˆØ§Ù„Ø£Ø¯Ø¨', 'self-dev': 'Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', 'history': 'Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„Ø­Ø¶Ø§Ø±Ø©', 'kids': 'Ø±ÙƒÙ† Ø§Ù„Ø·ÙÙ„', 'science': 'Ø§Ù„Ø¹Ù„ÙˆÙ… ÙˆØ§Ù„Ù…Ø¹Ø±ÙØ©', 'psychology': 'Ø¹Ù„Ù… Ø§Ù„Ù†ÙØ³', 'philosophy': 'ÙÙ„Ø³ÙØ©', 'spirituality': 'Ø±ÙˆØ­Ø§Ù†ÙŠØ§Øª', 'short-stories': 'Ù…Ø¬Ù…ÙˆØ¹Ø© Ù‚ØµØµÙŠØ©', 'biography': 'Ø³ÙŠØ±Ø© Ø°Ø§ØªÙŠØ©', 'poetry': 'Ø´Ø¹Ø±' };
        let cart = []; let currentSelectedBook = {}; 

        document.addEventListener('DOMContentLoaded', function() {
            // Intro Logic
            const introScreen = document.getElementById('intro-screen');
            const progressBar = document.getElementById('progress-bar');
            const loadingText = document.getElementById('loading-text');
            const mainStore = document.getElementById('main-store');
            const bookEmojisContainer = document.getElementById('book-emojis');
            let progress = 0;
            function spawnElegantBurst() {
                const count = 24; const angleStep = (2 * Math.PI) / count;
                for (let i = 0; i < count; i++) {
                    const bookEmoji = document.createElement('div'); bookEmoji.className = 'book-emoji';
                    bookEmoji.textContent = ['ğŸ“š', 'ğŸ“–', 'ğŸ“•', 'ğŸ“—', 'ğŸ“˜', 'ğŸ“™'][Math.floor(Math.random()*6)];
                    const angle = (i * angleStep) + (Math.random() * 0.1); const dist = 200 + Math.random() * 50; 
                    const tx = Math.cos(angle) * dist + 'px'; const ty = Math.sin(angle) * dist + 'px'; const rot = (Math.random() * 360) + 'deg';
                    bookEmoji.style.setProperty('--tx', tx); bookEmoji.style.setProperty('--ty', ty); bookEmoji.style.setProperty('--rot', rot);
                    bookEmojisContainer.appendChild(bookEmoji); setTimeout(() => { if(bookEmoji.parentNode) bookEmoji.parentNode.removeChild(bookEmoji); }, 3000);
                }
            }
            const interval = setInterval(() => {
                progress += 1; progressBar.style.width = progress + '%';
                if (progress >= 100) {
                    clearInterval(interval); loadingText.textContent = 'Ø¬Ø§Ù‡Ø²!';
                    spawnElegantBurst();
                    fetchBooksFromAPI().then(() => {
                        setTimeout(() => { introScreen.classList.add('fade-out'); setTimeout(() => { introScreen.style.display = 'none'; mainStore.classList.add('show-main'); }, 10); }, 10);
                    });
                }
            }, 10);
            setupSearch();
        });

        function activateSection(type) {
            fetchBooksFromAPI(type);
            document.getElementById('shelves-container').scrollIntoView({ behavior: 'smooth' });
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
            const btnSelector = type === 'sale' ? 'all' : type;
            const activeBtn = document.querySelector(`.cat-btn[data-filter="${btnSelector}"]`);
            if(activeBtn) activeBtn.classList.add('active');
            const fab = document.getElementById('share-fab-btn');
            if(type === 'share') fab.style.display = 'flex'; else fab.style.display = 'none';
            document.getElementById('search-input').value = '';
            const noRes = document.querySelector('.no-results-msg'); if(noRes) noRes.remove();
        }

        const navBorrowLink = document.getElementById('nav-borrow-link');
        const navShareLink = document.getElementById('nav-share-link');
        const mobileBorrowBtn = document.getElementById('mobile-borrow-btn');
        const mobileShareBtn = document.getElementById('mobile-share-btn');
        const navHomeLink = document.getElementById('nav-home-link');
        const mobileHomeBtn = document.getElementById('mobile-home-link');
        const sellLink = document.getElementById('sell-book-link');
        const mobileSellBtn = document.getElementById('mobile-sell-btn');
        const navAboutLink = document.getElementById('nav-about-link');

        if(navHomeLink) navHomeLink.onclick = (e) => { e.preventDefault(); activateSection('sale'); };
        if(mobileHomeBtn) mobileHomeBtn.onclick = (e) => { e.preventDefault(); activateSection('sale'); };
        if(navBorrowLink) navBorrowLink.onclick = (e) => { e.preventDefault(); activateSection('borrow'); };
        if(navShareLink) navShareLink.onclick = (e) => { e.preventDefault(); activateSection('share'); };
        if(mobileBorrowBtn) mobileBorrowBtn.onclick = (e) => { e.preventDefault(); activateSection('borrow'); };
        if(mobileShareBtn) mobileShareBtn.onclick = (e) => { e.preventDefault(); activateSection('share'); };

        function fetchBooksFromAPI(type = 'sale') {
            const container = document.getElementById('shelves-container');
            container.innerHTML = '<p style="text-align:center; padding:20px; color:#a17506;">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>';
            let action = 'getBooks'; if(type === 'borrow') action = 'getBorrowBooks'; if(type === 'share') action = 'getShareBooks';
            return fetch(scriptURL + "?action=" + action).then(response => response.json()).then(data => {
                container.innerHTML = ''; 
                if (!data || data.length === 0) { container.innerHTML = '<p style="text-align:center; padding:20px; color:#5d4037;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ØµØ± Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹.</p>'; return; }
                
                if (type === 'share') {
                    let html = '<div class="shelf-wrapper"><div class="shelf-title">Ù…Ø´Ø§Ø±ÙƒØ§Øª Ø§Ù„Ø·Ù„Ø§Ø¨</div><div class="shelf-row"><div class="books-track">';
                    data.forEach(item => {
                          html += `<div class="book-item share-item" data-phone="${item.phone}" data-title="${item.title.toLowerCase()}"><div class="book-frame"><div class="book-price" style="background:#2196F3;color:white;border:none;">Ù…Ø¬Ø§Ù†ÙŠ</div><img src="${item.image}" class="book-cover" alt="${item.title}" onerror="this.src='https://via.placeholder.com/100x150?text=No+Image'"><div class="book-ribbon">${item.title}</div><span class="hidden-desc" style="display:none">${item.description || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ'}</span></div></div>`;
                    });
                    html += '</div><div class="wood-shelf"></div></div></div>';
                    container.innerHTML = html; return;
                }
                
                const booksByCategory = {};
                data.forEach(book => { if (!book.category) return; if (!booksByCategory[book.category]) booksByCategory[book.category] = []; booksByCategory[book.category].push(book); });
                for (const [catCode, catTitle] of Object.entries(categories)) {
                    if (booksByCategory[catCode] && booksByCategory[catCode].length > 0) {
                        const shelfWrapper = document.createElement('div'); shelfWrapper.className = 'shelf-wrapper'; shelfWrapper.setAttribute('data-category', catCode);
                        let booksHtml = '';
                        booksByCategory[catCode].forEach(book => {
                            const priceDisplay = type === 'borrow' ? 'Ù…Ø¬Ø§Ù†ÙŠ' : book.price;
                            const bookTypeClass = type === 'borrow' ? 'borrow-item' : 'sale-item';
                            const desc = book.description ? `<span class="hidden-desc" style="display:none">${book.description}</span>` : '';
                            booksHtml += `<div class="book-item ${bookTypeClass}" data-title="${book.title.toLowerCase()}"><div class="book-frame"><div class="book-price">${priceDisplay}</div><img src="${book.image}" class="book-cover" alt="${book.title}" onerror="this.src='https://via.placeholder.com/100x150?text=No+Image'"><div class="book-ribbon">${book.title}</div>${desc}</div></div>`;
                        });
                        shelfWrapper.innerHTML = `<div class="shelf-title">${catTitle}</div><div class="shelf-row"><div class="books-track">${booksHtml}</div><div class="wood-shelf"></div></div>`; container.appendChild(shelfWrapper);
                    }
                }
            });
        }

        function setupSearch() {
             const searchInput = document.getElementById('search-input');
             const shelvesContainer = document.getElementById('shelves-container');
             searchInput.addEventListener('input', function(e) {
                const query = e.target.value.trim().toLowerCase();
                const books = document.querySelectorAll('.book-item');
                const shelves = document.querySelectorAll('.shelf-wrapper');
                const oldMsg = document.querySelector('.no-results-msg'); if (oldMsg) oldMsg.remove();
                let hasResults = false;
                books.forEach(book => {
                    const title = book.getAttribute('data-title') || book.querySelector('.book-ribbon').innerText.toLowerCase();
                    if (title.includes(query)) { book.classList.remove('hidden-book'); hasResults = true; } else { book.classList.add('hidden-book'); }
                });
                shelves.forEach(shelf => {
                    const visibleBooks = shelf.querySelectorAll('.book-item:not(.hidden-book)');
                    if (visibleBooks.length > 0) shelf.classList.remove('hidden-shelf'); else shelf.classList.add('hidden-shelf');
                });
                if (!hasResults && query !== '') { const msg = document.createElement('div'); msg.className = 'no-results-msg'; msg.textContent = 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†ØªØ§Ø¦Ø¬ ğŸ˜”'; shelvesContainer.appendChild(msg); }
             });
        }

        document.querySelectorAll('.cat-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const filterValue = btn.getAttribute('data-filter');
                if(filterValue === 'all') activateSection('sale');
                else if(filterValue === 'borrow') activateSection('borrow');
                else if(filterValue === 'share') activateSection('share');
                else {
                    fetchBooksFromAPI('sale').then(() => {
                        const shelves = document.querySelectorAll('.shelf-wrapper');
                        shelves.forEach(shelf => {
                           if (shelf.getAttribute('data-category') === filterValue) shelf.classList.remove('hidden-shelf');
                           else shelf.classList.add('hidden-shelf');
                        });
                         document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
                         btn.classList.add('active');
                    });
                }
            });
        });

        // Modals & Click Handling
        const productModal = document.getElementById('product-modal-overlay');
        document.addEventListener('click', function(e) {
            const bookItem = e.target.closest('.book-item');
            if (bookItem) {
                const imgSrc = bookItem.querySelector('.book-cover').src;
                const title = bookItem.querySelector('.book-ribbon').innerText;
                const priceDiv = bookItem.querySelector('.book-price');
                const price = priceDiv ? priceDiv.innerText : '';
                const descSpan = bookItem.querySelector('.hidden-desc');
                const description = descSpan ? descSpan.innerText : "ÙƒØªØ§Ø¨ Ø±Ø§Ø¦Ø¹ Ù…Ù† Ù…Ø®ØªØ§Ø±Ø§Øª Ù†Ø§Ø¯ÙŠ Ø§Ù‚Ø±Ø£.";
                
                document.getElementById('modal-img').src = imgSrc;
                document.getElementById('modal-title').innerText = title;
                document.getElementById('modal-price').innerText = price;
                document.getElementById('modal-desc').innerText = description; 
                
                const actionBtn = document.getElementById('add-to-cart-btn');
                const isShare = bookItem.classList.contains('share-item');
                const isBorrow = bookItem.classList.contains('borrow-item');

                if (isShare) {
                    const phone = bookItem.getAttribute('data-phone');
                    actionBtn.innerHTML = "<span>ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø´Ø§Ø±Ùƒ</span><span>ğŸ’¬</span>";
                    actionBtn.onclick = function() { window.open(`https://wa.me/962${phone.substring(1)}?text=Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø¨Ø®ØµÙˆØµ Ù…Ø´Ø§Ø±ÙƒØªÙƒ: ${title}`, '_blank'); };
                    document.querySelector('.quantity-selector').style.display = 'none';
                } else if (isBorrow) {
                    actionBtn.innerHTML = "<span>Ø·Ù„Ø¨ Ø§Ø³ØªØ¹Ø§Ø±Ø©</span><span>ğŸ¤</span>";
                    actionBtn.onclick = function() { openBorrowModal(title); };
                    document.querySelector('.quantity-selector').style.display = 'none';
                    document.getElementById('modal-desc').innerText = "ÙƒØªØ§Ø¨ Ù…ØªØ§Ø­ Ù„Ù„Ø§Ø³ØªØ¹Ø§Ø±Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©.";
                } else {
                    actionBtn.innerHTML = "<span>Ø§Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©</span><span>ğŸ›ï¸</span>";
                    actionBtn.onclick = addToCartFunc;
                    document.querySelector('.quantity-selector').style.display = 'flex';
                    currentSelectedBook = { title, price, image: imgSrc };
                }
                productModal.classList.add('active');
            }
        });

        // Modal Close & Form Handling
        const closeProductModalBtn = document.getElementById('close-product-modal');
        const closeCartModalBtn = document.getElementById('close-cart-modal');
        const closeSellModalBtn = document.getElementById('close-sell-modal');
        const closeBorrowModalBtn = document.getElementById('close-borrow-modal');
        const closeAboutModalBtn = document.getElementById('close-about-modal');
        const closeShareModalBtn = document.getElementById('close-share-modal');
        
        const cartIcon = document.getElementById('cart-icon');
        cartIcon.onclick = () => { renderCartItems(); document.getElementById('cart-modal-overlay').classList.add('active'); };
        sellLink.onclick = (e) => { e.preventDefault(); document.getElementById('sell-modal-overlay').classList.add('active'); };
        mobileSellBtn.onclick = (e) => { e.preventDefault(); document.getElementById('sell-modal-overlay').classList.add('active'); };
        navAboutLink.onclick = (e) => { e.preventDefault(); document.getElementById('about-modal-overlay').classList.add('active'); };
        const shareFabBtn = document.getElementById('share-fab-btn');
        shareFabBtn.onclick = () => document.getElementById('share-modal-overlay').classList.add('active');

        function closeAllModals() {
             document.querySelectorAll('.modal-overlay').forEach(m => m.classList.remove('active'));
        }
        closeProductModalBtn.onclick = closeAllModals;
        closeCartModalBtn.onclick = closeAllModals;
        closeSellModalBtn.onclick = closeAllModals;
        closeBorrowModalBtn.onclick = closeAllModals;
        closeAboutModalBtn.onclick = closeAllModals;
        closeShareModalBtn.onclick = closeAllModals;
        
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.onclick = (e) => { if (e.target === overlay) closeAllModals(); }
        });

        function openBorrowModal(bookTitle) {
            closeAllModals();
            currentSelectedBook = { title: bookTitle };
            document.getElementById('borrow-modal-overlay').classList.add('active');
        }

        function addToCartFunc() {
             if (cart.some(item => item.title === currentSelectedBook.title)) { alert("Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„Ø³Ù„Ø©"); return; }
            cart.push(currentSelectedBook);
            updateCartCount();
            const btn = document.getElementById('add-to-cart-btn');
            const oldHTML = btn.innerHTML;
            btn.innerHTML = "<span>ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©!</span><span>âœ…</span>";
            btn.style.background = "#4caf50";
            setTimeout(() => {
                closeAllModals();
                setTimeout(() => {
                    btn.innerHTML = oldHTML;
                    btn.style.background = "linear-gradient(45deg, #a17506, #cfaa56)";
                }, 300);
            }, 800);
        }

        function updateCartCount() {
            document.getElementById('cart-count').innerText = cart.length;
            const icon = document.getElementById('cart-icon');
            icon.style.transform = 'scale(1.3)';
            setTimeout(() => icon.style.transform = 'scale(1)', 200);
        }

        window.removeFromCart = function(index) {
            cart.splice(index, 1);
            updateCartCount();
            renderCartItems();
        };
        
        function renderCartItems() {
            const container = document.getElementById('cart-items-container');
            const formContainer = document.getElementById('checkout-form-container');
            const totalEl = document.getElementById('cart-total');
            if (cart.length === 0) {
                container.innerHTML = '<p class="empty-cart-msg">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ© Ø­Ø§Ù„ÙŠØ§Ù‹ ğŸ˜”</p>';
                formContainer.style.display = 'none';
            } else {
                let html = '<div class="cart-items-list">';
                let total = 0;
                cart.forEach((item, index) => {
                    let priceVal = parseFloat(item.price.replace(/[^\d\.]/g, ''));
                    total += priceVal;
                    html += `<div class="cart-item-preview"><div class="cart-item-left"><button class="remove-item-btn" onclick="removeFromCart(${index})">&times;</button><img src="${item.image}" class="cart-item-img"><div class="cart-item-info"><h4>${item.title}</h4><span class="cart-item-price">${item.price}</span><span class="qty-badge">Ø§Ù„ÙƒÙ…ÙŠØ©: 1</span></div></div></div>`;
                });
                html += '</div>';
                container.innerHTML = html;
                totalEl.innerText = total.toFixed(2) + ' JD';
                formContainer.style.display = 'block';
            }
        }

        // Numeric Inputs
        const numericInputs = [ document.getElementById('phone'), document.getElementById('sell-phone'), document.getElementById('uni-id'), document.getElementById('sell-uni-id'), document.getElementById('borrow-phone'), document.getElementById('borrow-uni-id'), document.getElementById('share-phone') ];
        numericInputs.forEach(input => {
            if(input) {
                input.addEventListener('input', function() {
                    this.value = this.value.replace(/[^0-9]/g, '');
                    if (this.id.includes('phone') && this.value.length > 10) this.value = this.value.slice(0, 10);
                });
            }
        });

        // Forms Submission
        document.getElementById('checkout-form').onsubmit = function(e) {
            e.preventDefault();
            const phoneVal = document.getElementById('phone').value;
            if (phoneVal.length !== 10) { document.getElementById('phone-error').style.display = 'block'; return; }
            document.getElementById('phone-error').style.display = 'none';
            const btn = this.querySelector('button[type="submit"]');
            btn.innerHTML = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„..."; btn.disabled = true;
            const orderDetails = cart.map(item => item.title).join(", ");
            const formData = { action: 'addOrder', books: orderDetails, total: document.getElementById('cart-total').innerText, fname: document.getElementById('fname').value, lname: document.getElementById('lname').value, phone: phoneVal, uniId: document.getElementById('uni-id').value };
            fetch(scriptURL, { method: 'POST', headers: { "Content-Type": "text/plain;charset=utf-8" }, body: JSON.stringify(formData) })
            .then(() => { alert(`Ø´ÙƒØ±Ø§Ù‹! ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ.`); cart = []; updateCartCount(); this.reset(); closeAllModals(); })
            .finally(() => { btn.innerHTML = "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨"; btn.disabled = false; });
        };

        document.getElementById('sell-form').onsubmit = function(e) {
            e.preventDefault();
            const phoneVal = document.getElementById('sell-phone').value;
            if (phoneVal.length !== 10) { document.getElementById('sell-phone-error').style.display = 'block'; return; }
            document.getElementById('sell-phone-error').style.display = 'none';
            const desc = document.getElementById('sell-book-desc').value;
            
            const msg = `Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ…ØŒ Ø£Ø±ØºØ¨ Ø¨Ø¹Ø±Ø¶ ÙƒØªØ§Ø¨ Ù„Ù„Ø¨ÙŠØ¹:%0a` +
                        `ğŸ“š Ø§Ù„ÙƒØªØ§Ø¨: ${document.getElementById('sell-book-title').value}%0a` +
                        `ğŸ“‚ Ø§Ù„ØªØµÙ†ÙŠÙ: ${document.getElementById('sell-book-category').value}%0a` +
                        `ğŸ’° Ø§Ù„Ø³Ø¹Ø±: ${document.getElementById('sell-book-price').value} JD%0a` +
                        `ğŸ“ Ø§Ù„ÙˆØµÙ: ${desc}%0a` +
                        `ğŸ‘¤ Ø§Ù„Ø¨Ø§Ø¦Ø¹: ${document.getElementById('sell-fname').value} ${document.getElementById('sell-lname').value}%0a` +
                        `ğŸ“± Ù‡Ø§ØªÙ: ${phoneVal}%0a` +
                        `ğŸ†” Ø±Ù‚Ù… Ø¬Ø§Ù…Ø¹ÙŠ: ${document.getElementById('sell-uni-id').value}%0a%0a` +
                        `*Ø³Ø£Ø±Ø³Ù„ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø¢Ù†.*`;
            window.open(`https://wa.me/962790760808?text=${msg}`, '_blank');
            this.reset(); closeAllModals();
        };

        document.getElementById('borrow-form').onsubmit = function(e) {
            e.preventDefault();
            const phoneVal = document.getElementById('borrow-phone').value;
            if (phoneVal.length !== 10) { document.getElementById('borrow-phone-error').style.display = 'block'; return; }
            const msg = `Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø£Ø±ØºØ¨ Ø¨Ø§Ø³ØªØ¹Ø§Ø±Ø© ÙƒØªØ§Ø¨:%0ağŸ“š ${currentSelectedBook.title}%0ağŸ‘¤ ${document.getElementById('borrow-fname').value}%0ağŸ“± ${phoneVal}`;
            window.open(`https://wa.me/962790760808?text=${msg}`, '_blank');
            this.reset(); closeAllModals();
        };
        
        document.getElementById('share-form').onsubmit = function(e) {
            e.preventDefault();
            const phone = document.getElementById('share-phone').value;
            if (phone.length !== 10) { document.getElementById('share-phone-error').style.display = 'block'; return; }
            const btn = document.getElementById('share-submit-btn');
            btn.innerHTML = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹..."; btn.disabled = true;
            const file = document.getElementById('share-image-file').files[0];
            if(file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const img = new Image();
                    img.onload = function() {
                        const canvas = document.createElement('canvas'); const ctx = canvas.getContext('2d');
                        const maxWidth = 150; const scaleSize = maxWidth / img.width;
                        canvas.width = maxWidth; canvas.height = img.height * scaleSize;
                        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                        const dataUrl = canvas.toDataURL('image/jpeg', 0.7);
                        const formData = {
                            action: 'addShareBook',
                            title: document.getElementById('share-title').value,
                            description: document.getElementById('share-desc').value,
                            phone: phone,
                            image: dataUrl
                        };
                        fetch(scriptURL, { method: 'POST', headers: { "Content-Type": "text/plain;charset=utf-8" }, body: JSON.stringify(formData) })
                        .then(() => { alert("ØªÙ…Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø¨Ù†Ø¬Ø§Ø­!"); document.getElementById('share-form').reset(); closeAllModals(); activateSection('share'); })
                        .finally(() => { btn.innerHTML = "Ù†Ø´Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©"; btn.disabled = false; });
                    }
                    img.src = event.target.result;
                }
                reader.readAsDataURL(file);
            }
        };
    </script>
</body>
</html>
